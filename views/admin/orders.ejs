<%- include ('../layouts/adminHeader.ejs') %>
<%- include ('../layouts/adminProfileLeft.ejs') %>

  <div class="layout-page">
    <nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
      id="layout-navbar">
      <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
        <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
          <i class="bx bx-menu bx-sm"></i>
        </a>
      </div>
     
    </nav>
    <% if(typeof message !=='undefined' ) { %>
      <script>setTimeout(() => document.getElementById("addb").click(), 100)</script>
      <%} %>
      

      <div class="buy-now" style="margin-left: 40%;padding-bottom: 20px; display: flex;font-size: 18px;">
                <!-- <button type="submit" id="downloadPdfBtn" class="btn btn-success btn-buy-now" style="width: 200px;margin-right: 10px;">DOWNLOAD REPORT </button> -->
        <!-- <button type="button" id="downloadExcelBtn"  class="btn btn-success btn-buy-now">DOWNLOAD REPORT XL</button> -->
                    <a href="/admin/salesReport">SALES REPORT</a>
      
      </div> 
      
       
        <div class="page-wrapper">
          <div class="content-wrapper">
            <div class="container-xxl flex-grow-1 container-p-y">
              <div class="card" style="margin-left: 20%;">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Orders</h4>
                    <div class="table-responsive">
                      <table id='ordersTable' class="table table-hover  " style="table-layout: fixed;font-size: smaller;">
                        <thead>
                          <tr>
                            <th scope="col">SI NO</th>
                            <th scope="col">order Id</th>
                            <th scope="col">Username</th>
                            <th scope="col">Payment</th>
                            <th scope="col">Amount</th>
                            <th scope="col">Status</th>
                            
                          </tr>
                        </thead>
                        <tbody>
                          <% if( orders.length> 0){ %>
                            <% for(let i=0;i < orders.length; i++){ %>
                              <tr>
                                <td scope="row">
                                  <%= i + 1 %>
                                </td>
                                <td style="font-size: x-small;">
                                  #<%= orders[i]._id %>
                                </td>
                                <td>
                                    <%= orders[i].userId.name %>
                                </td>
                                <td>
                                  <%= orders[i].payment %>
                              </td>
                              <td>
                                â‚¹ <%= orders[i].amount %>.00
                            </td>
                                <td>
                                  <span class=" bg-label-<% if(orders[i].status =='Placed'){%>primary
                                    <%}else if(orders[i].status =='Accepted'){%>info
                                    <%}else if(orders[i].status =='Packed'){%>info
                                    <%}else if(orders[i].status =='Shipped'){%>info
                                    <%}else if(orders[i].status =='Delivered'){%>success
                                    <%}else if(orders[i].status =='Cancelled'){%>danger<%}%>    
                                       me-1"><%=orders[i].status %></span>
                                </td>
                                <td>
                                  <a href="/admin/orderDetails?id=<%= orders[i]._id %>"
                                  class="btn btn-success a-btn-slide-text btn-xs rounded"
                                  >

                                      <span class="glyphicon glyphicon-edit"
                                          aria-hidden="true"></span>
                                      <span><strong>view details</strong></span>
                              </a>
                             
                            </td>
                              </tr>
                              <% }} else { %>
                                <tr>
                                  <td colspan="5">orders Not Found</td>
                                </tr>
                                <% } %>

                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>



        <!-- test -->
        
       
  

<script>
  // Download as PDF
  // console.log(jsPDF);
document.getElementById('downloadPdfBtn').addEventListener('click', function() {
  // Get the table element


  var doc = new jsPDF()
    doc.autoTable({ html: '#ordersTable' })
    doc.save('SalesReport.pdf')
});

// Download as Excel
document.getElementById('downloadExcelBtn').addEventListener('click', function() {
  // Get the table element
  var table = document.getElementById('ordersTable');

  // Convert the table data to a worksheet object
  var worksheet = XLSX.utils.table_to_sheet(table);

  // Create a new workbook and add the worksheet
  var workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, 'Sales');

  // Save the Excel file
  XLSX.writeFile(workbook, 'SalesReport.xlsx');
});

</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.6/jspdf.plugin.autotable.min.js"></script>



<!-- SheetJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <%- include ('../layouts/adminFooter.ejs') %>